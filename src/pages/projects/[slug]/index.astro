---
import { getCollection, render } from "astro:content";
import BaseLayout from "@/layouts/BaseLayout.astro";
import Markdown from "@/components/Markdown.astro";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((p) => ({
    params: { slug: p.id },
    props: p,
  }));
}

const page = Astro.props;
const project = page;
const { Content } = await render(project);
---

<BaseLayout>
  <header class="container mt-4">
    <h1 class="text-2xl leading-tight font-medium tracking-tight">
      {project.data.title}
    </h1>
    <p class="text-muted-foreground max-w-[55ch] text-xl text-pretty">
      {project.data.description}
    </p>
  </header>

  <section class="bg-muted mx-auto mt-8 aspect-video max-w-4xl rounded-md">
  </section>

  <section class="container mt-4">
    <dl class="mt-8 grid grid-cols-[25%_1fr] gap-y-2">
      {
        project.data.meta.map(({ title, description }) => {
          return (
            <Fragment>
              <dt class="text-muted-foreground">{title}</dt>
              <dd class="pl-8">
                <Markdown content={description} />
              </dd>
            </Fragment>
          );
        })
      }
    </dl>
  </section>

  <section class="container mt-8">
    <div class="prose prose-longform">
      <Content />
    </div>
  </section>
</BaseLayout>
