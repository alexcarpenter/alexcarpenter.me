---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection, render } from "astro:content";

const entries = await getCollection("now");
const sortedEntries = entries.sort(
  (a, b) =>
    Date.parse(b.data.published.toString()) -
    Date.parse(a.data.published.toString()),
);
const renderedEntries = await Promise.all(
  sortedEntries.map(async (entry) => {
    const { Content } = await render(entry);
    return { entry, Content };
  }),
);
---

<BaseLayout title="Now">
  <header class="container">
    <h1
      class="text-3xl font-medium tracking-tight text-pretty [text-box-trim:trim-start]"
    >
      Now <span class="text-muted-foreground"> Now Now.</span>
    </h1>
  </header>
  <section class="container mt-20">
    <ul>
      {
        renderedEntries.map(({ entry, Content }) => (
          <li class="not-first:border-separator grid grid-cols-1 gap-10 not-first:mt-20 not-first:border-t not-first:pt-20 sm:grid-cols-[25%_1fr]">
            <time
              datetime={entry.data.published.toISOString()}
              class="text-muted-foreground"
            >
              {entry.data.published.toLocaleDateString("en-US", {
                year: "numeric",
                month: "short",
              })}
            </time>
            <div class="prose">
              <Content />
            </div>
          </li>
        ))
      }
    </ul>
  </section>
</BaseLayout>
