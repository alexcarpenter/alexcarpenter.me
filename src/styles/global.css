@tailwind base;
@tailwind components;
@tailwind utilities;

@font-face {
  font-family: "Geist Sans";
  src: url("/fonts/GeistVariableVF.woff2") format("woff2");
  font-display: swap;
  font-weight: 400 600;
}

@font-face {
  font-family: "Geist Mono";
  src: url("/fonts/GeistMonoVariableVF.woff2") format("woff2");
  font-display: swap;
  font-weight: 400;
}

@layer base {
  :root {
    color-scheme: dark;
  }

  pre {
    --pre-bg: theme(colors.neutral.950);
    @apply py-4 text-sm leading-6 !bg-[--pre-bg];
  }

  code {
    @apply isolate block w-fit min-w-full [counter-reset:line] *:inline-block *:w-full *:[counter-increment:line] *:before:pointer-events-none *:before:sticky *:before:left-0 *:before:z-20 *:before:inline-block *:before:w-11 *:before:select-none *:before:bg-gradient-to-r *:before:from-[--pre-bg] *:before:from-80% *:before:pr-4 *:before:text-right *:before:text-neutral-400 *:before:content-[counter(line)] *:after:pointer-events-none *:after:sticky *:after:right-0 *:after:z-10 *:after:inline-block *:after:w-6 *:after:select-none *:after:bg-gradient-to-l *:after:from-[--pre-bg] *:after:from-35% *:after:content-['_'];
  }

  mark {
    @apply -mx-0.5 inline rounded px-0.5 bg-amber-500/20 text-amber-100 [box-decoration-break:clone];
  }
}

@layer components {
  .prose {
    @apply space-y-4;

    & * + h2 {
      @apply text-lg pt-4 font-medium;
    }

    a {
      @apply underline decoration-2 decoration-neutral-600 hover:decoration-white;
    }

    ul {
      @apply list-square pl-4 marker:text-neutral-700 ml-2;
    }

    blockquote {
      @apply border-l-4 border-neutral-700 pl-4 ml-2 space-y-4;

      &:has(a[href*="https://x.com/hybrid_alex"])
      {
        @apply border-sky-300;
      }
    }

    pre {
      @apply border border-neutral-800 rounded-md overflow-hidden;
    }

    pre code span.line:last-of-type:empty {
      @apply hidden;
    }

    pre code .highlighted {
      --pre-bg: theme(colors.neutral.900);
      @apply bg-[--pre-bg];
    }

    :not(pre) > code,
    kbd {
      @apply -mx-0.5 inline rounded px-0.5 bg-neutral-800 [box-decoration-break:clone] text-[0.9375rem];
    }
  }

  /* Magic: https://x.com/myfonj/status/1828436893756698830 */
  .tag {
    @apply inline whitespace-nowrap;

    &::after {
      content: " ";
      word-spacing: 1em;
      background-image: linear-gradient(
        -0.2turn,
        transparent 0 calc(50% - 0.03em),
        theme(colors.neutral.700) 0 calc(50% + 0.03em),
        transparent 0
      );
    }
  }
}
